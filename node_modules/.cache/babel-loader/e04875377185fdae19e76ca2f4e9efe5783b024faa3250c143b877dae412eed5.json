{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import{authAPI}from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[artist,setArtist]=useState(null);const[loading,setLoading]=useState(true);const[token,setToken]=useState(localStorage.getItem('token'));useEffect(()=>{const initAuth=async()=>{const storedToken=localStorage.getItem('token');const storedArtist=localStorage.getItem('artist');if(storedToken&&storedArtist){try{// Verify token is still valid\nconst response=await authAPI.getCurrentUser();setArtist(response.data);setToken(storedToken);}catch(error){// Token is invalid, clear storage\nlocalStorage.removeItem('token');localStorage.removeItem('artist');setToken(null);setArtist(null);}}setLoading(false);};initAuth();},[]);const login=async(username,password)=>{try{const formData=new FormData();formData.append('username',username);formData.append('password',password);const response=await authAPI.login(formData);const{access_token}=response.data;// Get user profile\nlocalStorage.setItem('token',access_token);const userResponse=await authAPI.getCurrentUser();const artistData=userResponse.data;setToken(access_token);setArtist(artistData);localStorage.setItem('artist',JSON.stringify(artistData));return{success:true};}catch(error){var _error$response,_error$response$data;return{success:false,error:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Login failed'};}};const register=async userData=>{try{const response=await authAPI.register(userData);return{success:true,data:response.data};}catch(error){var _error$response2,_error$response2$data;return{success:false,error:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.detail)||'Registration failed'};}};const logout=()=>{localStorage.removeItem('token');localStorage.removeItem('artist');setToken(null);setArtist(null);};const isAuthenticated=()=>{return!!token&&!!artist;};const value={artist,token,loading,login,register,logout,isAuthenticated};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}